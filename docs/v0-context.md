# Claude Code Requirements Management Tool

## Project Overview

This is a Claude Code tool that transforms natural language feature descriptions into structured requirements using markdown templates, then generates code implementations with documentation feedback loops.

## Key Design Principles

- **Terminal-based** using Claude Code (no custom UI)
- **File-centric** approach using markdown for requirements
- **Repository-aware** code generation using existing patterns
- **Minimal user input** with maximum automation
- **Precise implementation boundaries** to prevent scope creep
- **Living documentation** that improves through implementation feedback

## Command Structure

### Primary Command: `/requires`

```bash
# Generate requirements from feature description
claude-code /requires "Feature description text"

# Plan implementation approach
claude-code /requires design [REQUIREMENT-ID]

# Generate code implementation
claude-code /requires implement [REQUIREMENT-ID]
```

## Requirement ID System

- **Hierarchical structure:** `FEATURE-1-2-3` using dash notation
- **Auto-generated** based on content analysis and hierarchy
- **Always has parent:** Top-level is feature, children are requirements
- **Example:** `USER-MGMT-1-2-1` (User Management → Authentication → Credential Validation → Input Validation)

## Language Standards

- **RFC-2119 compliance:** SHALL/SHOULD/MAY keywords (one per requirement)
- **ASD-STE100 language rules:** Structure and grammar rules, but not vocabulary restrictions
- **Controlled vocabulary:** Consistent terminology without rigid word limits

## Markdown Template Structure

```markdown
---
id: USER-MGMT-1-2                    # GENERATED BY CLAUDE
title: "Validate User Credentials"   # GENERATED BY CLAUDE
type: functional                     # GENERATED BY CLAUDE (functional/non-functional/constraint)
status: draft                        # GENERATED BY CLAUDE (draft/approved/implemented/tested)
parent: USER-MGMT-1                  # GENERATED BY CLAUDE
dependencies: []                     # GENERATED BY CLAUDE (requirement IDs this depends on)
conflicts: []                        # GENERATED BY CLAUDE (conflicting requirement IDs)
created: 2025-09-08                  # GENERATED BY CLAUDE
modified: 2025-09-08                 # GENERATED BY CLAUDE
author: username                     # GENERATED BY CLAUDE
version: 1.0                         # GENERATED BY CLAUDE
---

# USER-MGMT-1-2: Validate User Credentials

## Requirement Statement               # GENERATED BY CLAUDE
The system SHALL validate user email and password against the user database and return success or failure.

## Business Rationale                  # GENERATED BY CLAUDE
Core validation logic needed for user authentication workflow.

## Acceptance Criteria                 # GENERATED BY CLAUDE
**Implementation Note: Build ONLY what is specified below. Do not add functionality beyond these criteria.**

### Input Requirements
- [ ] Function accepts exactly two parameters: email (string) and password (string)
- [ ] Function validates email parameter is not null/empty
- [ ] Function validates password parameter is not null/empty
- [ ] Function returns error if either parameter is invalid

### Processing Requirements  
- [ ] Function queries user table using exact email match
- [ ] Function handles case when no user found (return authentication failure)
- [ ] Function retrieves stored password hash for matching user
- [ ] Function compares provided password against stored hash using bcrypt
- [ ] Function determines match/no-match result

### Output Requirements
- [ ] Function returns boolean true for successful authentication
- [ ] Function returns boolean false for failed authentication
- [ ] Function returns boolean false for non-existent user

### Error Handling
- [ ] Function throws DatabaseException for database connection errors
- [ ] Function throws ValidationException for invalid input parameters
- [ ] Function does NOT handle: password reset, account lockout, logging, rate limiting

### Integration Requirements
- [ ] Function integrates with existing UserRepository class
- [ ] Function uses existing PasswordHasher utility
- [ ] Function follows existing error handling patterns in auth module
- [ ] Function does NOT create new database connections or utilities
```

## Implementation Workflow

### 0. Setup (One-time)
```bash
npx @technicallycorrect/requires init
```
- Installs `/requires` slash command to `~/.claude` directory
- Sets up necessary templates and configuration files
- Enables requirements workflow across all projects

### 1. Generate Requirements (`/requires "feature text"`)
- Parse natural language feature description
- Break into atomic requirements with RFC-2119 keywords
- Generate structured markdown files with comprehensive acceptance criteria
- Create hierarchical IDs and parent-child relationships
- Analyze dependencies and conflicts
- Present files for user review using Claude Code's preview system

### 2. Design Implementation (`/requires design [ID]`)
- Analyze requirement acceptance criteria for technical approach
- Identify files and components needing modification
- Suggest architecture patterns and integration points
- Create implementation plan with clear steps
- Validate technical feasibility

### 3. Implement Code (`/requires implement [ID]`)
- Read requirement markdown for implementation details
- Access existing codebase and CLAUDE.md files for context
- Generate code meeting ONLY specified acceptance criteria
- Follow existing patterns and conventions
- Provide documentation feedback for CLAUDE.md improvements

## Documentation Feedback System

During implementation, Claude analyzes CLAUDE.md files and provides feedback:

### Types of Feedback
- **Missing Documentation:** Technical details needed for implementation
- **Outdated Information:** Code changes that invalidated documentation  
- **Inconsistent Patterns:** Where code and docs don't align
- **Integration Gaps:** Missing information about component connections

### Example Feedback Format
```markdown
## Implementation Complete: USER-MGMT-1-2

### Code Changes
- Added validateCredentials() function to /auth/services/AuthService.js
- Updated /auth/index.js exports

### Documentation Feedback

#### Missing Documentation
- /auth/CLAUDE.md needs error handling standards section
- /database/CLAUDE.md should document user table schema

#### Recommended Updates
1. Add to /auth/CLAUDE.md:
   ## Error Handling Standards
   - ValidationError: Invalid input parameters
   - DatabaseError: Database connection issues

2. Add to /database/CLAUDE.md:
   ## User Table Schema
   - id: UUID primary key
   - email: VARCHAR(255) unique
   - password_hash: VARCHAR(255)

#### Outdated Information
- /auth/CLAUDE.md line 15 references deprecated UserModel - update to UserRepository
```

## File Organization

```
project-root/
├── requirements/
│   ├── USER-MGMT.md              # Feature-level requirement
│   ├── USER-MGMT-1.md            # User Registration
│   ├── USER-MGMT-1-1.md          # Email Validation
│   ├── USER-MGMT-1-2.md          # Password Hashing
│   ├── USER-MGMT-2.md            # User Authentication
│   └── USER-MGMT-2-1.md          # Credential Validation
├── src/
│   └── [source code]
└── docs/
    └── CLAUDE.md                 # This context file
```

## Key Automation Features

### What Claude Generates Automatically
- Requirement IDs (hierarchical with dash notation)
- All frontmatter metadata (timestamps, author, version, status)
- Parent-child relationships
- Dependency and conflict analysis
- Comprehensive acceptance criteria
- Business rationale from feature context

### What User Provides
- Natural language feature description
- Review and approval of generated requirements
- Manual edits to generated content if needed

## Implementation Constraints

### Strict Implementation Boundaries
- **Build ONLY** what is specified in acceptance criteria
- **Do NOT add** functionality beyond what is explicitly listed
- **No assumptions** about "obvious" features or improvements
- **Follow existing patterns** from codebase and CLAUDE.md files

### Quality Standards
- One RFC-2119 keyword per requirement
- Comprehensive acceptance criteria covering all aspects
- Clear negative criteria (what NOT to implement)
- Specific integration requirements with existing code

## Success Metrics

- Requirements clearly implementable without ambiguity
- Generated code meets acceptance criteria exactly
- Documentation gaps identified and resolved
- Consistent code patterns maintained across implementations
- Fast iteration from feature description to working code

## Development Notes

This tool is designed for:
- **Open source first version** using Claude Code
- **Professional services revenue** through consulting and training
- **Future SaaS expansion** with hosted version and team features
- **Repository-aware development** workflows